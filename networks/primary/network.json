{
    "version": 2.0,
    "types": {
        "HvCellboardId": {
            "type": "enum",
            "items": [
                "cellboard_0",
                "cellboard_1",
                "cellboard_2",
                "cellboard_3",
                "cellboard_4",
                "cellboard_5"
            ]
        },
        "HvMainboardStatus": {
            "type": "enum",
            "items": [
                "init",
                "idle",
                "fatal",
                "flash",
                "balancing",
                "airn_check",
                "precharge_check",
                "airp_check",
                "ts_on"
            ]
        },
        "HvCellboardStatus": {
            "type": "enum",
            "items": [
                "init",
                "idle",
                "fatal",
                "flash",
                "discharge",
                "cooldown"
            ]
        },
        "HvFeedback": {
            "type": "enum",
            "items": [
                "airn_open_com",
                "precharge_open_com",
                "airp_open_com",
                "airn_open_mec",
                "precharge_open_mec",
                "airp_open_mec",
                "sd_imd_fb",
                "sd_bms_fb",
                "ts_less_than_60v",
                "plausible_state_persisted",
                "plausible_state",
                "not_bms_fault_cockpit_led",
                "not_imd_fault_cockpit_led",
                "indicator_connected",
                "not_latch_reset",
                "plausible_state_latched",
                "not_bms_fault_latched",
                "not_imd_fault_latched",
                "not_ext_fault_latched",
                "imd_ok",
                "plausible_state_rc",
                "tsal_green",
                "probing_3v3",
                "sd_out",
                "sd_in",
                "sd_end",
                "v5_mcu",
                "unknown"
            ]
        },
        "HvFeedbackDigital": {
            "type": "bitset",
            "items": [
                "airn_open_com",
                "airp_open_com",
                "sd_imd_fb",
                "sd_bms_fb",
                "precharge_open_com",
                "precharge_open_mec",
                "ts_less_than_60v",
                "plausible_state_persisted",
                "plausible_state",
                "not_bms_fault_cockpit_led",
                "not_imd_fault_cockpit_led",
                "indicator_connected",
                "not_latch_reset",
                "plausible_state_latched",
                "not_bms_fault_latched",
                "not_imd_fault_latched",
                "not_ext_fault_latched"
            ]
        },
        "HvFeedbackStatus": {
            "type": "enum",
            "items": [
                "low",
                "error",
                "high"
            ]
        },
        "HvImdStatus": {
            "type": "enum",
            "items": [
                "unknown",
                "short_circuit",
                "normal",
                "under_voltage",
                "start_measure",
                "device_error",
                "earth_fault"
            ]
        }
    },
    "messages": [
        {
            "name": "HV_FLASH",
            "fixed_id": 0,
            "interval": 200,
            "sending": [
                "TLM"
            ],
            "receiving": [
                "HV"
            ],
            "description": "Start or stop the actual flash procedure, need a request first",
            "contents": {
                "start": "bool"
            }
        },
        {
            "name": "HV_FLASH_MAINBOARD_TX",
            "fixed_id": 1,
            "sending": [
                "HV"
            ],
            "receiving": [],
            "description": "Message used by openblt to receive data data FROM the microcontroller",
            "contents": {}
        },
        {
            "name": "HV_FLASH_MAINBOARD_RX",
            "fixed_id": 2,
            "sending": [
                "TLM"
            ],
            "receiving": [
                "HV"
            ],
            "description": "Message used by openblt to send data TO the microcontroller",
            "contents": {}
        },
        {
            "name": "HV_FLASH_CELLBOARD_0_TX",
            "fixed_id": 3,
            "sending": [
                "HV"
            ],
            "receiving": [],
            "description": "Message used by openblt to receive data data FROM the microcontroller",
            "contents": {}
        },
        {
            "name": "HV_FLASH_CELLBOARD_0_RX",
            "fixed_id": 4,
            "sending": [
                "TLM"
            ],
            "receiving": [
                "HV"
            ],
            "description": "Message used by openblt to send data TO the microcontroller",
            "contents": {}
        },
        {
            "name": "HV_FLASH_CELLBOARD_1_TX",
            "fixed_id": 5,
            "sending": [
                "HV"
            ],
            "receiving": [],
            "description": "Message used by openblt to receive data data FROM the microcontroller",
            "contents": {}
        },
        {
            "name": "HV_FLASH_CELLBOARD_1_RX",
            "fixed_id": 6,
            "sending": [
                "TLM"
            ],
            "receiving": [
                "HV"
            ],
            "description": "Message used by openblt to send data TO the microcontroller",
            "contents": {}
        },
        {
            "name": "HV_FLASH_CELLBOARD_2_TX",
            "fixed_id": 7,
            "sending": [
                "HV"
            ],
            "receiving": [],
            "description": "Message used by openblt to receive data data FROM the microcontroller",
            "contents": {}
        },
        {
            "name": "HV_FLASH_CELLBOARD_2_RX",
            "fixed_id": 8,
            "sending": [
                "TLM"
            ],
            "receiving": [
                "HV"
            ],
            "description": "Message used by openblt to send data TO the microcontroller",
            "contents": {}
        },
        {
            "name": "HV_FLASH_CELLBOARD_3_TX",
            "fixed_id": 9,
            "sending": [
                "HV"
            ],
            "receiving": [],
            "description": "Message used by openblt to receive data data FROM the microcontroller",
            "contents": {}
        },
        {
            "name": "HV_FLASH_CELLBOARD_3_RX",
            "fixed_id": 10,
            "sending": [
                "TLM"
            ],
            "receiving": [
                "HV"
            ],
            "description": "Message used by openblt to send data TO the microcontroller",
            "contents": {}
        },
        {
            "name": "HV_FLASH_CELLBOARD_4_TX",
            "fixed_id": 11,
            "sending": [
                "HV"
            ],
            "receiving": [],
            "description": "Message used by openblt to receive data data FROM the microcontroller",
            "contents": {}
        },
        {
            "name": "HV_FLASH_CELLBOARD_4_RX",
            "fixed_id": 12,
            "sending": [
                "TLM"
            ],
            "receiving": [
                "HV"
            ],
            "description": "Message used by openblt to send data TO the microcontroller",
            "contents": {}
        },
        {
            "name": "HV_FLASH_CELLBOARD_5_TX",
            "fixed_id": 13,
            "sending": [
                "HV"
            ],
            "receiving": [],
            "description": "Message used by openblt to receive data data FROM the microcontroller",
            "contents": {}
        },
        {
            "name": "HV_FLASH_CELLBOARD_5_RX",
            "fixed_id": 14,
            "sending": [
                "TLM"
            ],
            "receiving": [
                "HV"
            ],
            "description": "Message used by openblt to send data TO the microcontroller",
            "contents": {}
        },
        {
            "name": "HV_FLASH_REQUEST",
            "fixed_id": 15,
            "sending": [
                "TLM"
            ],
            "receiving": [
                "HV"
            ],
            "description": "Flash procedure request for a single board of the High-Voltage BMS",
            "contents": {
                "mainboard": "bool",
                "cellboard_id": "HvCellboardId"
            }
        },
        {
            "name": "HV_FLASH_RESPONSE",
            "fixed_id": 16,
            "sending": [
                "HV"
            ],
            "receiving": [],
            "description": "Reponse to a flash request",
            "contents": {
                "ready": "bool"
            }
        },
        {
            "name": "HV_MAINBOARD_VERSION",
            "fixed_id": 702,
            "interval": 1000,
            "sending": [
                "HV"
            ],
            "receiving": [],
            "description": "High-Voltage mainboard version: build-time timestamp and canlib build-time timestamp",
            "contents": {
                "canlib_build_time": "uint32",
                "component_build_time": "uint32"
            }
        },
        {
            "name": "HV_CELLBOARD_VERSION",
            "fixed_id": 705,
            "interval": 1000,
            "sending": [
                "HV"
            ],
            "receiving": [],
            "description": "High-Voltage cellboard version: build-time timestamp and canlib build-time timestamp",
            "contents": {
                "cellboard_id": "HvCellboardId",
                "canlib_build_time": "uint32",
                "component_build_time": {
                    "type": "uint32",
                    "range": [
                        0,
                        536870911
                    ],
                    "precision": 1,
                    "comment": "The build time is expressed in seconds with the 3 least significant bits truncated to fit into the CAN payload"
                }
            }
        },
        {
            "name": "HV_STATUS",
            "topic": "HYDRA",
            "priority": 1,
            "interval": 20,
            "sending": [
                "HV"
            ],
            "receiving": [],
            "description": "Mainboard and cellboard internal FSM status",
            "contents": {
                "status": "HvMainboardStatus",
                "cellboard_0": "HvCellboardStatus",
                "cellboard_1": "HvCellboardStatus",
                "cellboard_2": "HvCellboardStatus",
                "cellboard_3": "HvCellboardStatus",
                "cellboard_4": "HvCellboardStatus",
                "cellboard_5": "HvCellboardStatus"
            }
        },
        {
            "name": "HV_SET_STATUS_ECU",
            "topic": "HYDRA",
            "priority": 0,
            "interval": 50,
            "sending": [
                "ECU"
            ],
            "receiving": [
                "HV"
            ],
            "description": "Change the mainboard status from the ECU",
            "contents": {
                "status": "bool"
            }
        },
        {
            "name": "HV_SET_STATUS_HANDCART",
            "topic": "HYDRA",
            "priority": 0,
            "interval": 50,
            "sending": [
                "HANDCART"
            ],
            "receiving": [
                "HV"
            ],
            "description": "Change the mainboard status from the handcart",
            "contents": {
                "status": "bool"
            }
        },
        {
            "name": "HV_SET_BALANCING_STATUS",
            "topic": "HYDRA",
            "priority": 2,
            "interval": 200,
            "sending": [
                "STEERING_WHEEL",
                "HANDCART"
            ],
            "receiving": [
                "HV"
            ],
            "description": "Start or stop the balancing procedure",
            "contents": {
                "status": "bool",
                "threshold": {
                    "type": "float32",
                    "force": "uint16",
                    "range": [
                        0.005,
                        0.2
                    ],
                    "comment": "The maximum allowed delta between the highest and lowest cell voltages in V"
                }
            }
        },
        {
            "name": "HV_CURRENT",
            "topic": "HYDRA",
            "priority": 3,
            "interval": 20,
            "sending": [
                "HV"
            ],
            "receiving": [],
            "description": "Mainboard current in A",
            "contents": {
                "current": {
                    "type": "float",
                    "range": [
                        -39,
                        135
                    ],
                    "precision": 0.001,
                    "comment": "The current sensor has a resolution of +/-10mA"
                }
            }
        },
        {
            "name": "HV_CELLS_VOLTAGE",
            "topic": "HYDRA",
            "priority": 2,
            "interval": 50,
            "sending": [
                "HV"
            ],
            "receiving": [],
            "description": "Cells voltages in V",
            "contents": {
                "cellboard_id": "HvCellboardId",
                "offset": {
                    "type": "uint8",
                    "force": "uint8",
                    "range": [
                        0,
                        21
                    ],
                    "precision": 3,
                    "comment": "Offset from the first cell of the segment"
                },
                "voltage_0": {
                    "type": "float",
                    "range": [
                        0,
                        5
                    ],
                    "precision": 0.0013
                },
                "voltage_1": {
                    "type": "float",
                    "range": [
                        0,
                        5
                    ],
                    "precision": 0.0013
                },
                "voltage_2": {
                    "type": "float",
                    "range": [
                        0,
                        5
                    ],
                    "precision": 0.0013
                }
            }
        },
        {
            "name": "HV_FEEDBACK_STATUS",
            "topic": "HYDRA",
            "priority": 1,
            "interval": 50,
            "sending": [
                "HV"
            ],
            "receiving": [
                "ECU",
                "HANDCART"
            ],
            "description": "Status of all the BMS HV feedbacks",
            "contents": {
                "airn_open_com": "HvFeedbackStatus",
                "precharge_open_com": "HvFeedbackStatus",
                "airp_open_com": "HvFeedbackStatus",
                "airn_open_mec": "HvFeedbackStatus",
                "precharge_open_mec": "HvFeedbackStatus",
                "airp_open_mec": "HvFeedbackStatus",
                "sd_imd_fb": "HvFeedbackStatus",
                "sd_bms_fb": "HvFeedbackStatus",
                "ts_less_than_60v": "HvFeedbackStatus",
                "plausible_state_persisted": "HvFeedbackStatus",
                "plausible_state": "HvFeedbackStatus",
                "not_bms_fault_cockpit_led": "HvFeedbackStatus",
                "not_imd_fault_cockpit_led": "HvFeedbackStatus",
                "indicator_connected": "HvFeedbackStatus",
                "not_latch_reset": "HvFeedbackStatus",
                "plausible_state_latched": "HvFeedbackStatus",
                "not_bms_fault_latched": "HvFeedbackStatus",
                "not_imd_fault_latched": "HvFeedbackStatus",
                "not_ext_fault_latched": "HvFeedbackStatus",
                "imd_ok": "HvFeedbackStatus",
                "plausible_state_rc": "HvFeedbackStatus",
                "tsal_green": "HvFeedbackStatus",
                "probing_3v3": "HvFeedbackStatus",
                "sd_out": "HvFeedbackStatus",
                "sd_in": "HvFeedbackStatus",
                "sd_end": "HvFeedbackStatus",
                "v5_mcu": "HvFeedbackStatus"
            }
        },
        {
            "name": "HV_FEEDBACK_DIGITAL",
            "topic": "HYDRA",
            "priority": 1,
            "interval": 50,
            "sending": [
                "HV"
            ],
            "receiving": [
                "ECU",
                "HANDCART"
            ],
            "description": "Values of the BMS HV digital feedbacks",
            "contents": {
                "digital": "HvFeedbackDigital"
            }
        },
        {
            "name": "HV_FEEDBACK_ANALOG",
            "topic": "HYDRA",
            "priority": 1,
            "interval": 50,
            "sending": [
                "HV"
            ],
            "receiving": [
                "ECU",
                "HANDCART"
            ],
            "description": "Voltages of the BMS HV analog feedbacks",
            "contents": {
                "analog_airn_open_mec": {
                    "type": "float32",
                    "force": "uint8",
                    "range": [
                        0,
                        3.3
                    ]
                },
                "analog_airp_open_mec": {
                    "type": "float32",
                    "force": "uint8",
                    "range": [
                        0,
                        3.3
                    ]
                },
                "analog_imd_ok": {
                    "type": "float32",
                    "force": "uint8",
                    "range": [
                        0,
                        3.3
                    ]
                },
                "analog_plausible_state_rc": {
                    "type": "float32",
                    "force": "uint8",
                    "range": [
                        0,
                        3.3
                    ]
                },
                "analog_tsal_green": {
                    "type": "float32",
                    "force": "uint8",
                    "range": [
                        0,
                        3.3
                    ]
                },
                "analog_probing_3v3": {
                    "type": "float32",
                    "force": "uint8",
                    "range": [
                        0,
                        3.3
                    ]
                },
                "analog_v5_mcu": {
                    "type": "float32",
                    "force": "uint8",
                    "range": [
                        0,
                        5
                    ]
                }
            }
        },
        {
            "name": "HV_FEEDBACK_ANALOG_SD",
            "topic": "HYDRA",
            "priority": 1,
            "interval": 50,
            "sending": [
                "HV"
            ],
            "receiving": [
                "ECU",
                "HANDCART"
            ],
            "description": "Voltages of the BMS HV analog shutdown circuit feedbacks",
            "contents": {
                "sd_out": {
                    "type": "float32",
                    "range": [
                        0,
                        12
                    ],
                    "precision": 0.001
                },
                "sd_in": {
                    "type": "float32",
                    "range": [
                        0,
                        12
                    ],
                    "precision": 0.001
                },
                "sd_end": {
                    "type": "float32",
                    "range": [
                        0,
                        12
                    ],
                    "precision": 0.001
                }
            }
        },
        {
            "name": "HV_FEEDBACK_ENZOMMA",
            "topic": "HYDRA",
            "priority": 1,
            "sending": [
                "HV"
            ],
            "receiving": [
                "ECU",
                "HANDCART"
            ],
            "description": "Info regarding the feedback that did not allow the BMS to go in the TS ON state",
            "contents": {
                "feedback": "HvFeedback",
                "status": "HvFeedbackStatus",
                "is_digital": "bool",
                "digital": "bool",
                "analog": {
                    "type": "float32",
                    "force": "uint16",
                    "range": [
                        0,
                        3.3
                    ]
                }
            }
        },
        {
            "name": "HV_IMD_STATUS",
            "topic": "HYDRA",
            "priority": 1,
            "interval": 20,
            "sending": [
                "HV"
            ],
            "receiving": [
                "ECU",
                "HANDCART"
            ],
            "description": "Internal status of the IMD",
            "contents": {
                "status": "HvImdStatus",
                "frequency": {
                    "type": "float32",
                    "force": "uint8",
                    "range": [
                        0.0,
                        60.0
                    ],
                    "comment": "IMD frequency in Hz"
                },
                "duty_cycle": {
                    "type": "float32",
                    "force": "uint8",
                    "range": [
                        0,
                        1
                    ],
                    "comment": "IMD duty cycle percentage"
                },
                "feedback_not_imd_fault_cockpit_led": "HvFeedbackStatus",
                "feedback_not_imd_fault_latched": "HvFeedbackStatus"
            }
        }
    ]
}
